{"name":"Manual de Instalação do Geplanes - jBoss7","tagline":"","body":"## 1 - Tutorial para usar o geplanes no JBoss 7.1.1\r\n\r\nNo manual de instalação/atualização é descrito em maiores detalhes a instalação e configuração do geplanes:\r\n\r\n[http://www.softwarepublico.gov.br/dotlrn/clubs/geplanes/file-storage/view/metodologia-bsc/vers-es/geplanes-3-0-3/Manual_de_Atualiza%C3%A7%C3%A3o_para_a_Vers%C3%A3o_3.0.3.pdf](http://www.softwarepublico.gov.br/dotlrn/clubs/geplanes/file-storage/view/metodologia-bsc/vers-es/geplanes-3-0-3/Manual_de_Atualiza%C3%A7%C3%A3o_para_a_Vers%C3%A3o_3.0.3.pdf)\r\n\r\n## 2 - Aqui mostraremos apenas o que configurar no JBoss 7 para que o geplanes funcione adequadamente\r\n\r\n<b>Observações:</b>\r\n\r\n* O arquivo build <b>geplanes_bsc.war</b> é o mesmo, apenas serão alterados alguns arquivos de configuração do próprio JBoss.\r\n\r\n* Não é necessário alterar a configuração de memória de inicialização do jboss uma vez que por padrão ele já incializa com 2GB de ram.\r\n\r\n* O arquivo <b>jboss7+geplanes3.0.3.tar</b> já vem com o jboss configurado e com o geplanes junto.\r\n\r\n## 2.1 - Editar o arquivo applicationConfig.xml\r\n\r\nEditar o arquivo <i>applicationConfig.xml</i> em (<i>path/jboss-7.1.1.Final/standalone/deployments/geplanes_bsc.war/WEB-INF</i>)\r\n\r\nAdicione o seguinte trecho logo após o bean <i>\"authenticationConfig\"</i>:\r\n\r\n    <bean id=\"dataSource\"\r\n        class=\"br.com.linkcom.sgm.util.JndiGeplanesFactory\">\r\n    </bean>\r\n\r\n## 2.2 - Editar o arquivo standalone.xml\r\n\r\nEditar o arquivo <i>standalone.xml</i> em (<i>path/jboss-7.1.1.Final/standalone/configuration</i>)\r\n\r\nAdicione os trechos dentro da tag <i><datasources></i>. Essa configuração substitui a configuração do banco de dados definida no arquivo <i>geplanes_bsc_geplanes-ds.xml</i> utilizada para a versÃ£o 4.5 do JBoss.\r\n\r\nNo exemplo abaixo o ip do servidor do banco de dados é o 10.0.1.6.\r\n\r\n    <datasources>\r\n        <datasource jta=\"false\" jndi-name=\"java:/10.0.1.6_geplanes_bsc_PostgreSQLDS\" pool-name=\"postgresDS05\" enabled=\"true\" use-java-context=\"true\" use-ccm=\"false\">\r\n          <connection-url>jdbc:postgresql://localhost:5432/geplanes_bsc</connection-url>\r\n          <driver-class>org.postgresql.Driver</driver-class>\r\n          <driver>postgresql</driver>\r\n          <pool>\r\n            <min-pool-size>2</min-pool-size>\r\n            <max-pool-size>20</max-pool-size>\r\n          </pool>\r\n          <security>\r\n            <user-name>postgres</user-name>\r\n            <password>postgres</password>\r\n          </security>\r\n          <validation>\r\n            <validate-on-match>false</validate-on-match>\r\n            <background-validation>false</background-validation>\r\n            <background-validation-millis>1</background-validation-millis>\r\n          </validation>\r\n          <statement>\r\n            <prepared-statement-cache-size>0</prepared-statement-cache-size>\r\n            <share-prepared-statements>false</share-prepared-statements>\r\n          </statement>\r\n        </datasource>\r\n        <datasource jta=\"false\" jndi-name=\"java:/geplanes_bsc_PostgreSQLDS\" pool-name=\"postgresDS01\" enabled=\"true\" use-java-context=\"true\" use-ccm=\"false\">\r\n          <connection-url>jdbc:postgresql://localhost:5432/geplanes_bsc</connection-url>\r\n            <driver-class>org.postgresql.Driver</driver-class>\r\n            <driver>postgresql</driver>\r\n            <pool>\r\n              <min-pool-size>2</min-pool-size>\r\n              <max-pool-size>20</max-pool-size>\r\n            </pool>\r\n            <security>\r\n              <user-name>postgres</user-name>\r\n              <password>postgres</password>\r\n            </security>\r\n            <validation>\r\n              <validate-on-match>false</validate-on-match>\r\n              <background-validation>false</background-validation>\r\n              <background-validation-millis>1</background-validation-millis>\r\n            </validation>\r\n            <statement>\r\n              <prepared-statement-cache-size>0</prepared-statement-cache-size>\r\n              <share-prepared-statements>false</share-prepared-statements>\r\n            </statement>\r\n        </datasource>\r\n        <datasource jta=\"false\" jndi-name=\"java:/127.0.0.1_geplanes_bsc_PostgreSQLDS\" pool-name=\"postgresDS02\" enabled=\"true\" use-java-context=\"true\" use-ccm=\"false\">\r\n          <connection-url>jdbc:postgresql://localhost:5432/geplanes_bsc</connection-url>\r\n          <driver-class>org.postgresql.Driver</driver-class>\r\n          <driver>postgresql</driver>\r\n          <pool>\r\n            <min-pool-size>2</min-pool-size>\r\n            <max-pool-size>20</max-pool-size>\r\n          </pool>\r\n          <security>\r\n            <user-name>postgres</user-name>\r\n            <password>postgres</password>\r\n          </security>\r\n          <validation>\r\n            <validate-on-match>false</validate-on-match>\r\n            <background-validation>false</background-validation>\r\n            <background-validation-millis>1</background-validation-millis>\r\n          </validation>\r\n          <statement>\r\n            <prepared-statement-cache-size>0</prepared-statement-cache-size>\r\n            <share-prepared-statements>false</share-prepared-statements>\r\n          </statement>\r\n        </datasource>\r\n        <datasource jta=\"false\" jndi-name=\"java:/localhost_geplanes_bsc_PostgreSQLDS\" pool-name=\"postgresDS\" enabled=\"true\" use-java-context=\"true\" use-ccm=\"false\">\r\n          <connection-url>jdbc:postgresql://localhost:5432/geplanes_bsc</connection-url>\r\n          <driver-class>org.postgresql.Driver</driver-class>\r\n          <driver>postgresql</driver>\r\n          <pool>\r\n            <min-pool-size>2</min-pool-size>\r\n            <max-pool-size>20</max-pool-size>\r\n          </pool>\r\n          <security>\r\n            <user-name>postgres</user-name>\r\n            <password>postgres</password>\r\n          </security>\r\n          <validation>\r\n            <validate-on-match>false</validate-on-match>\r\n            <background-validation>false</background-validation>\r\n            <background-validation-millis>1</background-validation-millis>\r\n          </validation>\r\n          <statement>\r\n            <prepared-statement-cache-size>0</prepared-statement-cache-size>\r\n            <share-prepared-statements>false</share-prepared-statements>\r\n          </statement>\r\n        </datasource>\r\n        <datasource jndi-name=\"java:jboss/datasources/ExampleDS\" pool-name=\"ExampleDS\" enabled=\"true\" use-java-context=\"true\">\r\n            <connection-url>jdbc:h2:mem:test;DB_CLOSE_DELAY=-1</connection-url>\r\n            <driver>h2</driver>\r\n            <security>\r\n              <user-name>sa</user-name>\r\n              <password>sa</password>\r\n            </security>\r\n        </datasource>\r\n            <drivers>\r\n              <driver name=\"h2\" module=\"com.h2database.h2\">\r\n                <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>\r\n              </driver>\r\n              <driver name=\"postgresql\" module=\"org.postgresql\">\r\n                <xa-datasource-class>org.postgresql.xa.PGXADataSource</xa-datasource-class>\r\n              </driver>\r\n            </drivers>\r\n      </datasources>\r\n\r\n## 2.3 - Criar o arquivo geplanes_bsc.war.dodeploy\r\n\r\nCriar o arquivo <b>geplanes_bsc.war.dodeploy</b> no caminho <i>path/jboss-7.1.1.Final/standalone/deployments</i> com o seguinte conteúdo:\r\n   \r\n    geplanes_bsc.war\r\n\r\n## 2.4 - Copiar o driver do postgresql postgresql-9.2-1002.jdbc4.jar\r\n\r\nCopiar o driver do postgresql (<i>postgresql-9.2-1002.jdbc4.jar</i>) dentro da pasta <i>path/jboss-7.1.1.Final/modules/org/postgresql/main</i>\r\n\r\n## 2.5 - Criar um script para facilitar a inicialização do jBoss.\r\n\r\nCriar o arquivo com o nome jboss7 na pasta <i>/etc/init.d</i>\r\n \r\n     # sudo nano /etc/init.d/jboss7\r\n\r\nColar o conteúdo:\r\n  \r\n     #!/bin/bash\r\n     #Define JBOSS_HOME\r\n     JBOSS_HOME=/path/jboss-7.1.1.Final\r\n\r\n     case \"$1\" in\r\n     start)\r\n     echo \"Subindo JBoss AS7...\"\r\n     sh ${JBOSS_HOME}/bin/standalone.sh & > /dev/null\r\n\r\n     ;;\r\n     stop)\r\n     echo \"parando JBoss AS7...\"\r\n     sh ${JBOSS_HOME}/bin/jboss-cli.sh --connect command=:shutdown\r\n     ;;\r\n     log)\r\n     echo \"log server.log...\"\r\n      tail -1000f ${JBOSS_HOME}/standalone/log/server.log\r\n     ;;\r\n     *)\r\n     echo \"Use: /etc/init.d/jboss7 {start|stop|log}\"\r\n     exit 1\r\n     ;; esac\r\n     exit 0\r\n\r\n\r\nE agorar dar permissÃ£o de execução ao arquivo:\r\n\r\n    # sudo chmod +x /etc/init.d/jboss7\r\n\r\nPara iniciar o serviço:\r\n\r\n    # sudo /etc/init.d/jboss7 start\r\n\r\nE para parar o serviço:\r\n\r\n    # sudo /etc/init.d/jboss7 stop\r\n\r\n}\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}